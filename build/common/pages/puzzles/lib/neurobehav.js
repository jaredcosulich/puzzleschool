// Generated by CoffeeScript 1.3.3
var fn, name, neurobehav, _ref,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

neurobehav = typeof exports !== "undefined" && exports !== null ? exports : provide('./lib/neurobehav', {});

_ref = require('./neurobehav_objects/index');
for (name in _ref) {
  fn = _ref[name];
  neurobehav[name] = fn;
}

neurobehav.ViewHelper = (function() {

  ViewHelper.prototype.$ = function(selector) {
    return $(selector, this.el);
  };

  function ViewHelper(_arg) {
    this.el = _arg.el;
    this.showMoreSidebarContent = __bind(this.showMoreSidebarContent, this);

    this.oscilloscopeScreen = this.$('.oscilloscope');
    this.game = new neurobehav.Game({
      el: this.el
    });
    this.initGoalDescription();
    this.initHints();
  }

  ViewHelper.prototype.initGoalDescription = function() {
    var goalDescription, showGoalDescription,
      _this = this;
    goalDescription = this.$('.show_goal_description');
    showGoalDescription = function() {
      var offset;
      offset = goalDescription.offset();
      _this.showMoreSidebarContent(_this.goalDescriptionHtml, offset.top + offset.height + 6);
      return goalDescription.one('click', function() {
        _this.initGoalDescription();
        return _this.hideMoreSidebarContent();
      });
    };
    return goalDescription.one('click', function() {
      return showGoalDescription();
    });
  };

  ViewHelper.prototype.initHints = function() {
    var hints, showHint,
      _this = this;
    hints = this.$('.hints');
    showHint = function() {
      var offset;
      offset = hints.offset();
      _this.showMoreSidebarContent('<br/><br/><p style=\'text-align: center;\'>No Hints Yet</p><br/><br/>', offset.top + offset.height + 6);
      return hints.one('click', function() {
        _this.initHints();
        return _this.hideMoreSidebarContent();
      });
    };
    return hints.one('click', function() {
      return showHint();
    });
  };

  ViewHelper.prototype.showMoreSidebarContent = function(html, top) {
    var content, height;
    this.moreSidebarContent = this.$('.more_info');
    this.moreSidebarContent.css({
      height: 'auto',
      left: -1000,
      top: -1000
    });
    content = this.moreSidebarContent.find('.content');
    content.html(html);
    height = this.moreSidebarContent.height();
    content.css({
      height: height
    });
    this.moreSidebarContent.css({
      height: 0,
      left: this.oscilloscopeScreen.offset().left,
      top: top
    });
    return this.moreSidebarContent.animate({
      height: height,
      duration: 250
    });
  };

  ViewHelper.prototype.hideMoreSidebarContent = function() {
    var _this = this;
    return this.moreSidebarContent.animate({
      height: 0,
      duration: 250,
      complete: function() {
        return _this.moreSidebarContent.css({
          height: 'auto',
          left: -1000,
          top: -1000
        });
      }
    });
  };

  ViewHelper.prototype.loadFirstLevel = function() {
    var neuron1, neuron2, oscilloscope, stimulus;
    stimulus = this.game.addObject({
      type: 'Stimulus',
      position: {
        top: 100,
        left: 100
      },
      voltage: 1.5,
      duration: 250
    });
    neuron1 = this.game.addObject({
      type: 'Neuron',
      position: {
        top: 100,
        left: 300
      },
      threshold: 1,
      spike: 0.5
    });
    stimulus.connectTo(neuron1);
    neuron2 = this.game.addObject({
      type: 'Neuron',
      position: {
        top: 300,
        left: 200
      },
      threshold: 1,
      spike: 0.5
    });
    oscilloscope = this.game.addObject({
      type: 'Oscilloscope',
      position: {
        top: 80,
        left: 340
      },
      container: this.oscilloscopeScreen
    });
    oscilloscope.attachTo(neuron1);
    return this.goalDescriptionHtml = "<h4>Get The Heart To Beat</h4>\n<p>Using the red button add enough electricity to the neuron to cause it to exceed it's threshold.</p>\n<p>The threshold line is depicted below in the oscilloscope screen as a dashed green line.</p>";
  };

  return ViewHelper;

})();
