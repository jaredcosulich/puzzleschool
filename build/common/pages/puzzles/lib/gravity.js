// Generated by CoffeeScript 1.3.3
var gravity;

gravity = typeof exports !== "undefined" && exports !== null ? exports : provide('./lib/gravity', {});

gravity.ViewHelper = (function() {

  function ViewHelper(_arg) {
    this.el = _arg.el;
    this.wells = [];
    this.initGravityWell();
  }

  ViewHelper.prototype.$ = function(selector) {
    return $(selector, this.el);
  };

  ViewHelper.prototype.initGravityWell = function() {
    var _this = this;
    this.modifyWells();
    return this.el.bind('mousedown.well', function(e) {
      var well;
      well = new gravity.Well(_this.el, e.offsetX, e.offsetY);
      well.grow();
      _this.el.bind('mouseup.well', function(e) {
        return well.shrink();
      });
      return _this.wells.push(well);
    });
  };

  ViewHelper.prototype.modifyWells = function() {
    var well, _i, _len, _ref,
      _this = this;
    _ref = this.wells;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      well = _ref[_i];
      well.modify();
    }
    return setTimeout((function() {
      return _this.modifyWells();
    }), 10);
  };

  return ViewHelper;

})();

gravity.Well = (function() {

  Well.prototype.MAX_RADIUS = 25;

  function Well(container, x, y) {
    this.container = container;
    this.x = x;
    this.y = y;
    this.el = $(document.createElement('DIV'));
    this.el.addClass('well');
    this.el.css({
      left: x,
      top: y
    });
    this.radius = 0;
    this.container.append(this.el);
  }

  Well.prototype["delete"] = function() {
    return this.el.remove();
  };

  Well.prototype.grow = function() {
    return this.rate = 1;
  };

  Well.prototype.shrink = function() {
    return this.rate = -1;
  };

  Well.prototype.stop = function() {
    return delete this.rate;
  };

  Well.prototype.modify = function() {
    if (this.rate == null) {
      return;
    }
    this.radius += this.rate;
    if (this.radius > this.MAX_RADIUS) {
      this.stop();
      return;
    }
    if (this.radius < 0) {
      this["delete"]();
    }
    return this.el.css({
      boxShadow: "0px 0 " + (this.radius * 2) + "px " + this.radius + "px rgba(255,255,255,0.8)"
    });
  };

  return Well;

})();
