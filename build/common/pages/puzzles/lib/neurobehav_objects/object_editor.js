// Generated by CoffeeScript 1.3.3
var objectEditor;

objectEditor = typeof exports !== "undefined" && exports !== null ? exports : provide('./object_editor', {});

objectEditor.ObjectEditor = (function() {

  function ObjectEditor(_arg) {
    this.el = _arg.el;
    this.init();
  }

  ObjectEditor.prototype.$ = function(selector) {
    return this.el.find(selector);
  };

  ObjectEditor.prototype.init = function() {
    this.explicitContent = this.$('.explicit_content');
    this.nothingSelected = this.$('.nothing_selected');
    this.objectProperties = this.$('.object_properties');
    return this.objectType = this.$('.object_type');
  };

  ObjectEditor.prototype.show = function(element, name, properties) {
    var previouslySelectedElement, propertyId, _fn,
      _this = this;
    this.name = name;
    this.properties = properties;
    this.hideExtraContent();
    this.explicitContent.html(this.properties.description);
    previouslySelectedElement = this.element;
    this.element = element;
    this.nothingSelected.hide();
    this.objectProperties.show();
    this.objectProperties.html('');
    _fn = function(propertyId) {
      var input, property;
      property = _this.properties[propertyId];
      _this.objectProperties.append("<p>" + property.name + ": \n    <span class='" + propertyId + "'>" + (_this["" + property.type + "Element"](property)) + "</span> (" + property.unitName + ")\n</p>");
      input = _this.objectProperties.find("." + propertyId).find('input, select');
      return input.bind('change keypress', function() {
        var value;
        value = parseFloat(input.val());
        property.value = value;
        if (property.set) {
          return property.set(value);
        }
      });
    };
    for (propertyId in this.properties) {
      if (propertyId === 'description') {
        continue;
      }
      _fn(propertyId);
    }
    this.objectType.html(this.name);
    return previouslySelectedElement;
  };

  ObjectEditor.prototype.hide = function(element) {
    if (element && element !== this.element) {
      return;
    }
    this.objectProperties.hide();
    return this.nothingSelected.show();
  };

  ObjectEditor.prototype.set = function(id, value) {
    value = parseFloat(value);
    this.objectProperties.find("." + id).find('input, select').val(value + '');
    if (this.properties) {
      return this.properties[id].value = value;
    }
  };

  ObjectEditor.prototype.selectElement = function(property) {
    var options, selected, value, _i, _ref, _ref1, _ref2;
    options = [];
    for (value = _i = _ref = property.min || 0, _ref1 = property.max, _ref2 = property.unit; _ref <= _ref1 ? _i <= _ref1 : _i >= _ref1; value = _i += _ref2) {
      selected = ("" + value) === ("" + property.value);
      options.push("<option value=" + value + " " + (selected ? 'selected=selected' : '') + ">" + value + "</option>");
    }
    return "<select>" + (options.join('')) + "</select>";
  };

  ObjectEditor.prototype.showExtraContent = function(html) {
    var content;
    this.extraContent = html;
    content = $(document.createElement('DIV'));
    content.html(html);
    content.addClass('extra_content');
    content.height(0);
    this.el.append(content);
    return content.animate({
      height: this.el.height(),
      duration: 750
    });
  };

  ObjectEditor.prototype.hideExtraContent = function() {
    var _this = this;
    this.extraContent = null;
    return this.$('.extra_content').animate({
      height: 0,
      duration: 250,
      complete: function() {
        return _this.$('.extra_content').remove();
      }
    });
  };

  return ObjectEditor;

})();
